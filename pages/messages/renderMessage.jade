mixin renderMessage(message, user)
	.post
		.post-author
			a.user(href='/+' + message.author.nick, title=message.author.nick)
				img.user-image(src=message.author.avatar + '?s=50&r=x')
				
			if message.recipient && message.recipient.id !== message.author.id
				a.user.message-recipient(href='/+' + message.recipient.nick, title=message.recipient.nick)
					img.user-image(src=message.recipient.avatar + '?s=50&r=x')
		.post-content!= app.markdown(message.text)
			.post-toolbar
				.spacer
				a.ajax(href='/messages/' + message.id, title='Permalink')
					i.fa.fa-link.fa-fw
				if user
					if user.id !== message.authorId
						a(onclick='window.likeMessage()', title='Like')
							i.fa.fa-thumbs-up.fa-fw
					if user.id === message.authorId
						a(onclick='window.editMessage()', title='Edit')
							i.fa.fa-pencil.fa-fw
					if user.id === message.authorId || user.id === message.recipientId
						a(onclick=`if(confirm("Do you really want to delete this message from ${message.author.nick}?")) window.deleteMessage('${message.id}')`, title='Delete')
							i.fa.fa-trash.fa-fw